<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>SciKit-Learn linear regression</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 id="scikit-learn-linear-regression" data-anchor-id="ffub">SciKit-Learn linear regression</h1><p data-anchor-id="c5l7"><code>SciKit-Learn</code> <code>线性回归</code><a href="../index.html" style="float:right"><strong>Home</strong></a></p><hr><div class="md-section-divider"></div><h3 id="线性回归" data-anchor-id="ch29">线性回归</h3><div class="md-section-divider"></div><pre style="" data-anchor-id="dpbx" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="com"># 可视化包</span></code></li><li class="L1"><code class="language-python"><span class="pun">%</span><span class="pln">matplotlib inline</span></code></li><li class="L2"><code class="language-python"><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></code></li><li class="L3"><code class="language-python"><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">pyplot </span><span class="kwd">as</span><span class="pln"> plt</span></code></li><li class="L4"><code class="language-python"><span class="kwd">import</span><span class="pln"> seaborn</span><span class="pun">;</span><span class="pln"> </span></code></li><li class="L5"><code class="language-python"><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">linear_model </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">LinearRegression</span></code></li><li class="L6"><code class="language-python"><span class="kwd">import</span><span class="pln"> pylab </span><span class="kwd">as</span><span class="pln"> pl</span></code></li><li class="L7"><code class="language-python"></code></li><li class="L8"><code class="language-python"><span class="pln">seaborn</span><span class="pun">.</span><span class="pln">set</span><span class="pun">()</span></code></li></ol></pre><p data-anchor-id="7tic">回归模型是一种监督模型，用于刻画因变量y与一组自变量x之间的关系。</p><div class="md-section-divider"></div><pre style="" data-anchor-id="l850" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="com"># 生成实验数据</span></code></li><li class="L1"><code class="language-python"><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></code></li><li class="L2"><code class="language-python"><span class="pln">np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">seed</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"><span class="pln">X </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">random</span><span class="pun">(</span><span class="pln">size</span><span class="pun">=(</span><span class="lit">20</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span></code></li><li class="L4"><code class="language-python"><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> X</span><span class="pun">.</span><span class="pln">squeeze</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">randn</span><span class="pun">(</span><span class="lit">20</span><span class="pun">)</span></code></li><li class="L5"><code class="language-python"></code></li><li class="L6"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">plot</span><span class="pun">(</span><span class="pln">X</span><span class="pun">.</span><span class="pln">squeeze</span><span class="pun">(),</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> </span><span class="str">'o'</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="6v1f"><img src="http://static.zybuluo.com/ronaldhan/mkepzk7gekl5h192qzk4oe90/output_4_0.png" alt="output_4_0.png-5.3kB" title=""></p><div class="md-section-divider"></div><pre style="" data-anchor-id="cz8h" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">model </span><span class="pun">=</span><span class="pln"> </span><span class="typ">LinearRegression</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="pln">model</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"></code></li><li class="L3"><code class="language-python"><span class="com"># Plot the data and the model prediction</span></code></li><li class="L4"><code class="language-python"><span class="pln">X_fit </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">linspace</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">100</span><span class="pun">)[:,</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">newaxis</span><span class="pun">]</span></code></li><li class="L5"><code class="language-python"><span class="pln">y_fit </span><span class="pun">=</span><span class="pln"> model</span><span class="pun">.</span><span class="pln">predict</span><span class="pun">(</span><span class="pln">X_fit</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"></code></li><li class="L7"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">plot</span><span class="pun">(</span><span class="pln">X</span><span class="pun">.</span><span class="pln">squeeze</span><span class="pun">(),</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> </span><span class="str">'o'</span><span class="pun">)</span></code></li><li class="L8"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">plot</span><span class="pun">(</span><span class="pln">X_fit</span><span class="pun">.</span><span class="pln">squeeze</span><span class="pun">(),</span><span class="pln"> y_fit</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="s14o"><img src="http://static.zybuluo.com/ronaldhan/laq65onc6y75ztm3a0qqf0x3/output_6_0.png" alt="output_6_0.png-10.4kB" title=""></p></div>
</body>
</html>