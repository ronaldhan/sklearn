<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>SciKit-Learn SVM</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
</head>
<body class="theme theme-white">
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"><path d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z" stroke-width="1" id="MJMATHI-4F"></path><path d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" stroke-width="1" id="MJMAIN-33"></path></defs></svg></div><div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 id="scikit-learn-svm" data-anchor-id="dfr3">SciKit-Learn SVM</h1><p data-anchor-id="baap"><code>SciKit-Learn</code> <code>SVM</code> <code>支持向量机</code><a href="../index.html" style="float:right"><strong>Home</strong></a></p><hr><div class="md-section-divider"></div><h3 id="内容目录" data-anchor-id="bldj">内容目录</h3><p data-anchor-id="abvt"><div class="toc"><div class="toc">
<ul>
<li><a href="#scikit-learn-svm">SciKit-Learn SVM</a><ul>
<li><ul>
<li><a href="#内容目录">内容目录</a></li>
<li><a href="#支持向量机分类器">支持向量机分类器</a></li>
<li><a href="#基于核函数的支持向量机分类器">基于核函数的支持向量机分类器</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</p><div class="md-section-divider"></div><h3 id="支持向量机分类器" data-anchor-id="nnis">支持向量机分类器</h3><div class="md-section-divider"></div><pre style="" data-anchor-id="z3bo" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="com"># 可视化和科学计算包</span></code></li><li class="L1"><code class="language-python"><span class="pun">%</span><span class="pln">matplotlib inline</span></code></li><li class="L2"><code class="language-python"><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></code></li><li class="L3"><code class="language-python"><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">pyplot </span><span class="kwd">as</span><span class="pln"> plt</span></code></li><li class="L4"><code class="language-python"><span class="kwd">import</span><span class="pln"> seaborn</span><span class="pun">;</span><span class="pln"> </span></code></li><li class="L5"><code class="language-python"><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">linear_model </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">LinearRegression</span></code></li><li class="L6"><code class="language-python"><span class="kwd">from</span><span class="pln"> scipy </span><span class="kwd">import</span><span class="pln"> stats</span></code></li><li class="L7"><code class="language-python"><span class="kwd">import</span><span class="pln"> pylab </span><span class="kwd">as</span><span class="pln"> pl</span></code></li><li class="L8"><code class="language-python"></code></li><li class="L9"><code class="language-python"><span class="pln">seaborn</span><span class="pun">.</span><span class="pln">set</span><span class="pun">()</span></code></li></ol></pre><p data-anchor-id="u43y">SVM是一种强大的监督模型，可以用来进行分类或数据回归。SVM算法会计算不同类数据的边界，并通过最大化边界之间的距离来优化分类。先看一个示例。</p><div class="md-section-divider"></div><pre style="" data-anchor-id="50dk" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">datasets</span><span class="pun">.</span><span class="pln">samples_generator </span><span class="kwd">import</span><span class="pln"> make_blobs</span></code></li><li class="L1"><code class="language-python"><span class="pln">X</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> make_blobs</span><span class="pun">(</span><span class="pln">n_samples</span><span class="pun">=</span><span class="lit">50</span><span class="pun">,</span><span class="pln"> centers</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span></code></li><li class="L2"><code class="language-python"><span class="pln">                  random_state</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> cluster_std</span><span class="pun">=</span><span class="lit">0.60</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"></code></li><li class="L4"><code class="language-python"><span class="pln">xfit </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">linspace</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3.5</span><span class="pun">)</span></code></li><li class="L5"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">],</span><span class="pln"> X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">=</span><span class="lit">50</span><span class="pun">,</span><span class="pln"> cmap</span><span class="pun">=</span><span class="str">'spring'</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"></code></li><li class="L7"><code class="language-python"><span class="com"># Draw three lines that couple separate the data</span></code></li><li class="L8"><code class="language-python"><span class="kwd">for</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> d </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">[(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.65</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.33</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">0.5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1.6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.55</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(-</span><span class="lit">0.2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2.9</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2</span><span class="pun">)]:</span></code></li><li class="L9"><code class="language-python"><span class="pln">    yfit </span><span class="pun">=</span><span class="pln"> m </span><span class="pun">*</span><span class="pln"> xfit </span><span class="pun">+</span><span class="pln"> b</span></code></li><li class="L0"><code class="language-python"><span class="pln">    plt</span><span class="pun">.</span><span class="pln">plot</span><span class="pun">(</span><span class="pln">xfit</span><span class="pun">,</span><span class="pln"> yfit</span><span class="pun">,</span><span class="pln"> </span><span class="str">'-k'</span><span class="pun">)</span></code></li><li class="L1"><code class="language-python"><span class="pln">    plt</span><span class="pun">.</span><span class="pln">fill_between</span><span class="pun">(</span><span class="pln">xfit</span><span class="pun">,</span><span class="pln"> yfit </span><span class="pun">-</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> yfit </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> edgecolor</span><span class="pun">=</span><span class="str">'none'</span><span class="pun">,</span><span class="pln"> color</span><span class="pun">=</span><span class="str">'#AAAAAA'</span><span class="pun">,</span><span class="pln"> alpha</span><span class="pun">=</span><span class="lit">0.4</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"></code></li><li class="L3"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">xlim</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3.5</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="sa4y"><img src="http://static.zybuluo.com/ronaldhan/hh9x8kfw9hzvrw0fz5uvuu1n/output_5_1.png" alt="output_5_1.png-32.7kB" title=""> <br>
可以看出，可以画出多条线来划分数据，但哪个是最优的呢？通过SVM来进行分类。可以观察到数据是线性可分的，所以选择核为<code>linear</code></p><div class="md-section-divider"></div><pre style="" data-anchor-id="ajfb" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">svm </span><span class="kwd">import</span><span class="pln"> SVC</span></code></li><li class="L1"><code class="language-python"><span class="pln">clf </span><span class="pun">=</span><span class="pln"> SVC</span><span class="pun">(</span><span class="pln">kernel</span><span class="pun">=</span><span class="str">'linear'</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="pln">clf</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">)</span></code></li></ol></pre><pre data-anchor-id="05e1"><code># 模型概况
SVC(C=1.0, cache_size=200, class_weight=None, coef0=0.0, degree=3, gamma=0.0,
      kernel='linear', max_iter=-1, probability=False, random_state=None,
      shrinking=True, tol=0.001, verbose=False)
</code></pre><p data-anchor-id="mlp9">为了方便观察，需要将数据边界和分类边界画出来</p><div class="md-section-divider"></div><pre style="" data-anchor-id="lg6m" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="com"># 绘制分类边界和支持向量</span></code></li><li class="L1"><code class="language-python"><span class="kwd">def</span><span class="pln"> plot_svc_decision_function</span><span class="pun">(</span><span class="pln">clf</span><span class="pun">,</span><span class="pln"> ax</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">):</span></code></li><li class="L2"><code class="language-python"><span class="pln">    </span><span class="str">"""Plot the decision function for a 2D SVC"""</span></code></li><li class="L3"><code class="language-python"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> ax </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">:</span></code></li><li class="L4"><code class="language-python"><span class="pln">        ax </span><span class="pun">=</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">gca</span><span class="pun">()</span></code></li><li class="L5"><code class="language-python"><span class="pln">    x </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">linspace</span><span class="pun">(</span><span class="pln">plt</span><span class="pun">.</span><span class="pln">xlim</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">xlim</span><span class="pun">()[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> </span><span class="lit">30</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"><span class="pln">    y </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">linspace</span><span class="pun">(</span><span class="pln">plt</span><span class="pun">.</span><span class="pln">ylim</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">ylim</span><span class="pun">()[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> </span><span class="lit">30</span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">    Y</span><span class="pun">,</span><span class="pln"> X </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">meshgrid</span><span class="pun">(</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span></code></li><li class="L8"><code class="language-python"><span class="pln">    P </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">zeros_like</span><span class="pun">(</span><span class="pln">X</span><span class="pun">)</span></code></li><li class="L9"><code class="language-python"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> xi </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span></code></li><li class="L0"><code class="language-python"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> yj </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">y</span><span class="pun">):</span></code></li><li class="L1"><code class="language-python"><span class="pln">            P</span><span class="pun">[</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> clf</span><span class="pun">.</span><span class="pln">decision_function</span><span class="pun">([</span><span class="pln">xi</span><span class="pun">,</span><span class="pln"> yj</span><span class="pun">])</span></code></li><li class="L2"><code class="language-python"><span class="pln">    </span><span class="com"># plot the margins</span></code></li><li class="L3"><code class="language-python"><span class="pln">    ax</span><span class="pun">.</span><span class="pln">contour</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> Y</span><span class="pun">,</span><span class="pln"> P</span><span class="pun">,</span><span class="pln"> colors</span><span class="pun">=</span><span class="str">'k'</span><span class="pun">,</span></code></li><li class="L4"><code class="language-python"><span class="pln">               levels</span><span class="pun">=[-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> alpha</span><span class="pun">=</span><span class="lit">0.5</span><span class="pun">,</span></code></li><li class="L5"><code class="language-python"><span class="pln">               linestyles</span><span class="pun">=[</span><span class="str">'--'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'--'</span><span class="pun">])</span></code></li></ol></pre><div class="md-section-divider"></div><pre style="" data-anchor-id="2j28" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="com"># 数据点</span></code></li><li class="L1"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">],</span><span class="pln"> X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">=</span><span class="lit">50</span><span class="pun">,</span><span class="pln"> cmap</span><span class="pun">=</span><span class="str">'spring'</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="com"># 支持向量和分类向量</span></code></li><li class="L3"><code class="language-python"><span class="pln">plot_svc_decision_function</span><span class="pun">(</span><span class="pln">clf</span><span class="pun">)</span></code></li><li class="L4"><code class="language-python"><span class="com"># 支持向量上的点</span></code></li><li class="L5"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">clf</span><span class="pun">.</span><span class="pln">support_vectors_</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">],</span><span class="pln"> clf</span><span class="pun">.</span><span class="pln">support_vectors_</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span></code></li><li class="L6"><code class="language-python"><span class="pln">            s</span><span class="pun">=</span><span class="lit">200</span><span class="pun">,</span><span class="pln"> facecolors</span><span class="pun">=</span><span class="str">'none'</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="iiv9"><img src="http://static.zybuluo.com/ronaldhan/21pqlrkfo77vt4vi2f296aqc/output_11_1.png" alt="output_11_1.png-19.2kB" title=""></p><div class="md-section-divider"></div><h3 id="基于核函数的支持向量机分类器" data-anchor-id="fds8">基于核函数的支持向量机分类器</h3><p data-anchor-id="iyqi">数据集不一定都是线性可分的，在线性不可分的情况下，可以考虑使用核函数对数据集进行转换。以下为线性不可分的示例数据：</p><div class="md-section-divider"></div><pre style="" data-anchor-id="24fj" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">datasets</span><span class="pun">.</span><span class="pln">samples_generator </span><span class="kwd">import</span><span class="pln"> make_circles</span></code></li><li class="L1"><code class="language-python"><span class="pln">X</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> make_circles</span><span class="pun">(</span><span class="lit">100</span><span class="pun">,</span><span class="pln"> factor</span><span class="pun">=.</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> noise</span><span class="pun">=.</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"></code></li><li class="L3"><code class="language-python"><span class="pln">clf </span><span class="pun">=</span><span class="pln"> SVC</span><span class="pun">(</span><span class="pln">kernel</span><span class="pun">=</span><span class="str">'linear'</span><span class="pun">).</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">)</span></code></li><li class="L4"><code class="language-python"></code></li><li class="L5"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">],</span><span class="pln"> X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">=</span><span class="lit">50</span><span class="pun">,</span><span class="pln"> cmap</span><span class="pun">=</span><span class="str">'spring'</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"><span class="pln">plot_svc_decision_function</span><span class="pun">(</span><span class="pln">clf</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="wnrn"><img src="http://static.zybuluo.com/ronaldhan/a9iosbk32l8xxryyvzkinm67/output_15_0.png" alt="output_15_0.png-29.6kB" title=""> <br>
此时使用<code>linear</code>核没有办法正确划分数据，可以采用其他的核，比如径向基函数(RBF, radial basis function)核</p><div class="md-section-divider"></div><pre style="" data-anchor-id="0rrq" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">r </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">exp</span><span class="pun">(-(</span><span class="pln">X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">))</span></code></li><li class="L1"><code class="language-python"></code></li><li class="L2"><code class="language-python"><span class="kwd">from</span><span class="pln"> mpl_toolkits </span><span class="kwd">import</span><span class="pln"> mplot3d</span></code></li><li class="L3"><code class="language-python"></code></li><li class="L4"><code class="language-python"><span class="kwd">def</span><span class="pln"> plot_3D</span><span class="pun">(</span><span class="pln">elev</span><span class="pun">=</span><span class="lit">30</span><span class="pun">,</span><span class="pln"> azim</span><span class="pun">=</span><span class="lit">30</span><span class="pun">):</span></code></li><li class="L5"><code class="language-python"><span class="pln">    ax </span><span class="pun">=</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">subplot</span><span class="pun">(</span><span class="pln">projection</span><span class="pun">=</span><span class="str">'3d'</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"><span class="pln">    ax</span><span class="pun">.</span><span class="pln">scatter3D</span><span class="pun">(</span><span class="pln">X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">],</span><span class="pln"> X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">=</span><span class="lit">50</span><span class="pun">,</span><span class="pln"> cmap</span><span class="pun">=</span><span class="str">'spring'</span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">    ax</span><span class="pun">.</span><span class="pln">view_init</span><span class="pun">(</span><span class="pln">elev</span><span class="pun">=</span><span class="pln">elev</span><span class="pun">,</span><span class="pln"> azim</span><span class="pun">=</span><span class="pln">azim</span><span class="pun">)</span></code></li><li class="L8"><code class="language-python"><span class="pln">    ax</span><span class="pun">.</span><span class="pln">set_xlabel</span><span class="pun">(</span><span class="str">'x'</span><span class="pun">)</span></code></li><li class="L9"><code class="language-python"><span class="pln">    ax</span><span class="pun">.</span><span class="pln">set_ylabel</span><span class="pun">(</span><span class="str">'y'</span><span class="pun">)</span></code></li><li class="L0"><code class="language-python"><span class="pln">    ax</span><span class="pun">.</span><span class="pln">set_zlabel</span><span class="pun">(</span><span class="str">'r'</span><span class="pun">)</span></code></li><li class="L1"><code class="language-python"></code></li><li class="L2"><code class="language-python"><span class="pln">interact</span><span class="pun">(</span><span class="pln">plot_3D</span><span class="pun">,</span><span class="pln"> elev</span><span class="pun">=[-</span><span class="lit">90</span><span class="pun">,</span><span class="pln"> </span><span class="lit">90</span><span class="pun">],</span><span class="pln"> azip</span><span class="pun">=(-</span><span class="lit">180</span><span class="pun">,</span><span class="pln"> </span><span class="lit">180</span><span class="pun">));</span></code></li></ol></pre><p data-anchor-id="rsoc"><img src="http://static.zybuluo.com/ronaldhan/blu9kd91khoqwo52ofhc29ye/output_17_0.png" alt="output_17_0.png-36kB" title=""> <br>
在三维空间中可以看出数据是可分的。</p><div class="md-section-divider"></div><pre style="" data-anchor-id="y3ng" class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-python"><span class="com"># 使用rbf核对数据进行转换</span></code></li><li class="L1"><code class="language-python"><span class="pln">clf </span><span class="pun">=</span><span class="pln"> SVC</span><span class="pun">(</span><span class="pln">kernel</span><span class="pun">=</span><span class="str">'rbf'</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="pln">clf</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"></code></li><li class="L4"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">],</span><span class="pln"> X</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">=</span><span class="lit">50</span><span class="pun">,</span><span class="pln"> cmap</span><span class="pun">=</span><span class="str">'spring'</span><span class="pun">)</span></code></li><li class="L5"><code class="language-python"><span class="pln">plot_svc_decision_function</span><span class="pun">(</span><span class="pln">clf</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">clf</span><span class="pun">.</span><span class="pln">support_vectors_</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">],</span><span class="pln"> clf</span><span class="pun">.</span><span class="pln">support_vectors_</span><span class="pun">[:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span></code></li><li class="L7"><code class="language-python"><span class="pln">            s</span><span class="pun">=</span><span class="lit">200</span><span class="pun">,</span><span class="pln"> facecolors</span><span class="pun">=</span><span class="str">'none'</span><span class="pun">);</span></code></li></ol></pre><p data-anchor-id="e6bn"><img src="http://static.zybuluo.com/ronaldhan/yyotdlkdz29l7pnm8bu42qfo/output_19_0.png" alt="output_19_0.png-37.4kB" title=""></p><p data-anchor-id="1g9i">SVM的注意事项：</p><ul data-anchor-id="lplz">
<li>模型中使用的参数<code>c</code>和<code>gmma</code>是需要根据情况进行选择的，一般而言会事先设定多个值，通过搜索的方式找出最优参数</li>
<li>SVM的时间复杂度是<span class="MathJax_Preview"></span><span aria-readonly="true" role="textbox" id="MathJax-Element-38-Frame" class="MathJax_SVG" style="font-size: 100%; display: inline-block;"><svg viewBox="0 -854.728417598297 1217.406943983867 898.6317189263534" style="width: 2.778ex; height: 2.111ex; vertical-align: -0.222ex; margin: 1px 0px;" xmlns:xlink="http://www.w3.org/1999/xlink"><g transform="matrix(1 0 0 -1 0 0)" stroke-width="0" fill="black" stroke="black"><use xlink:href="#MJMATHI-4F"></use><use y="513" x="1079" xlink:href="#MJMAIN-33" transform="scale(0.7071067811865476)"></use></g></svg></span><script id="MathJax-Element-38" type="math/tex">O^3</script>级别的， LinearSVC是可扩展的，SVM本身并不是。对于大数据集最好先对数据进行降维等处理，在应用使用rbf核的LinearSVC模型。</li>
</ul></div>
</body>
</html>